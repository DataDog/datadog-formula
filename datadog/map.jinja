{% set os_family_map = salt['grains.filter_by']({
      'Debian': {},
      'RedHat': {},
    },
    grain="os_family")
%}

{% set default_settings = {
    'datadog': {
        'pkg_name': 'datadog-agent',
        'config_folder': '/etc/dd-agent',
        'config_file': 'datadog.conf',
        'checks_confd': '/etc/dd-agent/conf.d',
        'service_name': 'datadog-agent',
        'api_key': 'aaaaaaaabbbbbbbbccccccccdddddddd',
    }
}%}

{## Merge os_family_map into the default settings ##}
{% do default_settings.datadog.update(os_family_map) %}

{## Merge in datadog pillar ##}
{% set datadog_settings = salt['pillar.get']('datadog', default=default_settings.datadog, merge=True) %}
